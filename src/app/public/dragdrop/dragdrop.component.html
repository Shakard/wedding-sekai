<link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400" rel="stylesheet">
<ngx-spinner></ngx-spinner>
<div class="boxHeader">
</div>
<br>
<div class="buttons">
  <h1>Llenar <code>Mesas</code></h1>
  <button (click)="clearAllUsers()" class="up">Limpiar mesas</button>
  <button (click)="deleteAllElements()" class="up">Destruir elementos</button>
  <button pButton label="Resetear posiciÃ³n" (click)="resetTablesPosition()" style="color:#4f62fa"></button>
</div>
<br>
<div class="boxHeader">
</div>
<br>

<div class="main-container">
  <div class="box-container" >    
    <!-- =============================Toolbar============================= -->
    <ul id="toolbar" class="toolbar">
      <li class="active"><a id="tool-move"></a></li>
      <li><a id="tool-dining-table" (click)="onSubmitDiningTable()"></a></li>
      <li><a id="tool-bathroom-man" (click)="onSubmitBathroomMan()"></a></li>
      <li><a id="tool-bathroom-woman" (click)="onSubmitBathroomWoman()"></a></li>
      <li><a id="tool-stage" (click)="onSubmitBand()"></a></li>
      <li><a id="tool-dance-floor" (click)="onSubmitDanceFloor()"></a></li>
      <li><a id="tool-lounge" (click)="onSubmitLoungeRoom()"></a></li>
      <li><a id="tool-entrance" (click)="onSubmitEntrance()"></a></li>
      <li><a id="tool-exit" (click)="onSubmitExit()"></a></li>
      <li><a id="tool-candy-table" (click)="onSubmitCandyBar()"></a></li>
      <li><a id="tool-wedding-cake" (click)="onSubmitWeddingCake()"></a></li>
      <li><a id="tool-emergency-exit" (click)="onSubmitEmergencyExit()"></a></li>
      <li><a id="tool-catering" (click)="onSubmitCatering()"></a></li>
      <li><a id="tool-coffee-station" (click)="onSubmitCoffeeStation()"></a></li>
      <li><a id="tool-photo-booth" (click)="onSubmitPhotoBooth()"></a></li>
      <li><a id="tool-bar" (click)="onSubmitBar()"></a></li>
      <li><a id="tool-photo-area" (click)="onSubmitPhotoArea()"></a></li>
      <li><a id="tool-playground" (click)="onSubmitPlayground()"></a></li>
      <li><a id="tool-nursery" (click)="onSubmitNursery()"></a></li>
    </ul>


    <!-- =============================Sidebar============================= -->
    <div style="margin-left: 50px;
    border: 1px solid black;
    width: 65px;
    padding:5px;
    ">
      <small (click)="guestDeployed = !guestDeployed" style="color:black">invitados</small>
    </div>
    <div *ngIf="guestDeployed" class="contenedor-flexbox">
      <div class="sidebar">
        <div class="guests-container">
          <div id="invitados" dragula="SPILL" [(dragulaModel)]="users" class="guest-list">
            <div class="guest-box" *ngFor="let user of users">{{user.first_name}} {{user.last_name}}</div>
          </div>
        </div>
      </div>
    </div>


    <div #tableContainer class="container-tables" dragula="COLUMNS" [(dragulaModel)]="tables">
      <!-- ==================================Elementos del lienzo============================== -->
      <div id="{{canvasElement.id}}" *ngFor="let canvasElement of canvasElements; '$implicit.id' as i"
        class="tables-container" cdkDragBoundary=".box-container" (cdkDragEnded)="dragEnd($event)"
        (mouseover)="isHovered[i] = true" (mouseout)="onHoverOut(i)" cdkDrag>
        <div class="contenedor-flexbox">
          <div class="handle" cdkDragHandle>
            <img src="assets/images/svg_toolbar_icons/{{canvasElement.image}}">
          </div>
        </div>
        <div *ngIf="isHovered[i]" class="centered" style="color: #2b6777;
                  font-size: 14px;
                  transform: translate(30%, -240%);">
          {{canvasElement.name}}
          <button pButton pRipple icon="pi pi-trash" style="width: 20px; height:10px; bottom: 8px;"
            class="p-button-rounded p-button-danger" (click)="deleteElement(canvasElement)"></button>
        </div>
      </div>

      <!-- ========================Mesas con invitados=================================== -->
      <div id="{{table.id}}" *ngFor="let table of tables; '$implicit.id' as i" class="tables-container"
        cdkDragBoundary=".box-container" (cdkDragEnded)="dragEnd($event)"
        (mouseover)="isHovered[i] = true" (mouseout)="onHoverOut(i)" cdkDrag>
        <div class="contenedor-flexbox">
          <div class="handle" cdkDragHandle>
            <img src="assets/images/svg_toolbar_icons/{{table.image}}">
            <div *ngIf="isHovered[i]" class="centered" style="color:#2b6777;
                  font-size: 14px;
                  transform: translate(60%, -230%);">
              <p>{{table.name}}</p>
              <button pButton pRipple icon="pi pi-trash" style="width: 20px; height:10px; bottom: 8px;"
                class="p-button-rounded p-button-danger" (click)="deleteElement(table)"></button>
            </div>
            <small (click)="isToggled[i] = !isToggled[i]" class="tbl-counter">{{table.users_count}} invitados</small>
          </div>
        </div>
        <div *ngIf="isToggled[i]" class="table-guest-container">
          <div dragula="SPILL" [(dragulaModel)]="table.users" class="example-list">
            <div class="table-box" *ngFor="let user of table.users">{{user.first_name}} {{user.last_name}}</div>
          </div>
        </div>
      </div>


    </div>
    <div class="spacer"></div>
  </div>
</div>

<p-dialog [(visible)]="bathroomDialog" [style]="{width: '450px'}" [modal]="true" styleClass="p-fluid">
  <ng-template pTemplate="content">
    <form [formGroup]="formCanvasElement" (ngSubmit)="onSubmitBathroom()">
      <div class="p-field">
        <p-dropdown [options]="genders" formControlName="name" placeholder="Damas o Caballeros" [showClear]="true">
        </p-dropdown>
      </div>
      <br>
      <button type="submit" pButton pRipple label="Aceptar" icon="pi pi-save"
        class="p-button-success p-button-raised"></button>
    </form>
  </ng-template>
</p-dialog>