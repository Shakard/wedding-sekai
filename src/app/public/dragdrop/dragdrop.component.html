<link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400" rel="stylesheet">
<ngx-spinner></ngx-spinner>
<div class="boxHeader">
</div>
<br>
<div class="buttons">
  <h1>Llenar <code>Mesas</code></h1>
  <button (click)="clearAllUsers()" class="up">Limpiar mesas</button>
  <button pButton label="Resetear posición" (click)="resetTablesPosition()" style="color:#4f62fa"></button>
  <button (click)="onSubmitDiningTable()" class="offset">Agregar mesa</button>
  <button (click)="onSubmitBand()" class="offset">Agregar Banda</button>
  <button (click)="openNewBathroom()" class="offset">Agregar baño</button>
</div>
<br>
<div class="boxHeader">
</div>
<br>
<div class="contenedor-flexbox">

  <div class="sidebar">
    <div class="guests-container">
      <div id="invitados" dragula="SPILL" [(dragulaModel)]="users" class="guest-list">
        <div class="guest-box" *ngFor="let user of users">{{user.first_name}} {{user.last_name}}</div>
      </div>
    </div>
  </div>

</div>
<div class="main-container">
  <div class="box-container">
    <!-- ========================Mesas con invitados=================================== -->
    <div #tableContainer class="container-tables" dragula="COLUMNS" [(dragulaModel)]="tables">
      <div id="{{table.id}}" *ngFor="let table of tables; '$implicit.id' as i" class="tables-container"
        cdkDragBoundary=".box-container" (cdkDragEnded)="dragEnd($event)" cdkDrag>
        <div class="contenedor-flexbox">
          <div class="handle" cdkDragHandle>
            <img src="assets/images/dining-table.png">
            <div class="centered" style="color:rgb(1, 26, 26); font-size: 14px;">
              {{table.name}}
              <button pButton pRipple icon="pi pi-trash" style="width: 20px; height:10px; bottom: 8px;"
                class="p-button-rounded p-button-danger" (click)="deleteElement(table)"></button>
            </div>
            <small (click)="isToggled[i] = !isToggled[i]" class="tbl-counter">{{table.users_count}} invitados</small>
          </div>
        </div>
        <div *ngIf="isToggled[i]" class="table-guest-container">
          <div dragula="SPILL" [(dragulaModel)]="table.users" class="example-list">
            <div class="table-box" *ngFor="let user of table.users">{{user.first_name}} {{user.last_name}}</div>
          </div>
        </div>
      </div>

      <!-- ==================================Baños============================== -->
      <div id="{{bathroom.id}}" *ngFor="let bathroom of bathrooms; '$implicit.id' as i" class="tables-container"
        cdkDragBoundary=".box-container" (cdkDragEnded)="dragEnd($event)" cdkDrag>
        <div class="contenedor-flexbox">
          <div class="handle" cdkDragHandle>
            <img src="assets/images/bathroom.png">            
          </div>
        </div>
        <div class="centered" 
        style="color:rgb(1, 26, 26);
         font-size: 14px;
         transform: translate(-20%, -300%);"
         >
          {{bathroom.name}}
          <button pButton pRipple icon="pi pi-trash" style="width: 20px; height:10px; bottom: 8px;"
            class="p-button-rounded p-button-danger" (click)="deleteElement(bathroom)"></button>
        </div>
      </div>

      <!-- ==================================Banda============================== -->
      <div id="{{band.id}}" *ngFor="let band of bands; '$implicit.id' as i" class="tables-container"
        cdkDragBoundary=".box-container" (cdkDragEnded)="dragEnd($event)" cdkDrag>
        <div class="contenedor-flexbox">
          <div class="handle" cdkDragHandle>
            <img src="assets/images/band.png">            
          </div>
        </div>
        <div class="centered" 
        style="color:rgb(1, 26, 26);
         font-size: 14px;
         transform: translate(-20%, -300%);"
         >
          {{band.name}}
          <button pButton pRipple icon="pi pi-trash" style="width: 20px; height:10px; bottom: 8px;"
            class="p-button-rounded p-button-danger" (click)="deleteElement(band)"></button>
        </div>
      </div>

    </div>
    <div class="spacer"></div>
  </div>
</div>

<p-dialog [(visible)]="bathroomDialog" [style]="{width: '450px'}" [modal]="true"
	styleClass="p-fluid">
	<ng-template pTemplate="content">
		<form [formGroup]="formCanvasElement" (ngSubmit)="onSubmitBathroom()">
			<div class="p-field">
				<p-dropdown [options]="genders" formControlName="name" placeholder="Damas o Caballeros"
					 [showClear]="true"></p-dropdown>
			</div>
      <br>
      <button type="submit" pButton pRipple label="Aceptar" icon="pi pi-save"
				class="p-button-success p-button-raised"></button>
    </form> 
  </ng-template>   
</p-dialog>